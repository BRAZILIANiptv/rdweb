<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
	<head>
	<title>phpRDWeb - Registry Keys for Terminal Services</title>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<style id="settings">
body,h1,h2,h3,p,quote,small,form,input,ul,li,ol,label{margin:0;padding:0}
body,h1,h2,h3{font-family:verdana,arial,sans-serif;background:#fff;color:#4B4B4B;font-size:13px}
img{border:0}
a{text-decoration:none}
a:hover{text-decoration:underline}
#wrapper{margin:0 auto;width:1024px}
#header{text-align:center}
#headerimg{text-align:left;padding-top:10px;padding-bottom:10px;float:left}
#siteSearch{text-align:left;padding-left:10px;padding-top:10px;padding-bottom:10px;float:left}
#main-menu{text-align:left;float:left;background-color:#86C75F;width:100%}
#main-menu ul{margin:0;padding:5px}
#main-menu li{list-style-type:none;display:inline;margin:0 5px 0 5px}
#main-menu li a{color:#FFF;text-decoration:none}
#main-menu li a.active{color:#FFF}
#main-menu a:hover{text-decoration:underline;color:#FFF}
#breadcrumbs{font-size:9px;color:#4B4B4B;margin:7px 0 7px 0}
#breadcrumbs a{font-size:9px;color:#4B4B4B}
#main{border-top:1px solid black;border-bottom:1px solid black;width:100%}
#main td{vertical-align:top}
#leftCol{width:200px;border-right:1px solid black;padding:10px 0 10px 0}
.sideBar{margin-bottom:10px}
.sideBar h2{background:#86c75f;padding:5px;color:#fff}
.sideBar a{margin:10px 10px 0 10px;display:block;color:#4B4B4B}
#rightCol{padding:10px 0 10px 10px}
#footer{color:#000;padding-top:10px;padding-bottom:10px;text-align:center;line-height:1.5em}
.docBookTitle,.docPartTitle{font-family:Arial,Helvetica,sans-serif;font-size:x-large;line-height:118%;font-weight:bold}
.docPrefaceTitle,.docAppendixTitle,.docChapterTitle,.docBibliographyTitle,.docArticleTitle,.docGlossaryTitle{font-family:Arial,Helvetica,sans-serif;font-size:x-large;font-weight:bold}
.docSidebarTitle{font-family:Arial,Helvetica,sans-serif;font-size:x-large;font-weight:bold}
.docSection1Title,.docBibliodivTitle,.docBridgehead{font-family:Arial,Helvetica,sans-serif;font-size:large;font-weight:bold;margin-bottom:0}
.docSection2Title,.docBibliosetTitle{font-family:Arial,Helvetica,sans-serif;font-size:medium;font-weight:bold}
.docSection3Title,.docSection4Title,.docSection5Title{font-family:Arial,Helvetica,sans-serif;font-weight:bold}
.docFigureTitle,.docTableTitle,.docExampleTitle,.docTocTitle,.docAbstractTitle,.docQandasetTitle,.docProcTitle,.docRefsectTitle{font-family:Verdana,Arial,Helvetica,sans-serif;font-weight:bold}
.docText{font-family:Verdana,Arial,Helvetica,sans-serif}
.docList{font-family:Verdana,Arial,Helvetica,sans-serif}
.docMonofont{color:#790029;font-family:"Andale Mono","Courier New",Courier,monospace}
.docTableHeader,.docTableCell{font-family:Verdana,Arial,Helvetica,sans-serif}
.docTableFooter{font-family:Verdana,Arial,Helvetica,sans-serif}
.docRefCell{font-family:Verdana,Arial,Helvetica,sans-serif;font-size:medium}
.docTextHighlight{background-color:#FE9;color:#C00}
.docFootnote{color:#666}
.docItemizedlist{font-family:Verdana,Arial,Helvetica,sans-serif}
.docNote{margin-top:2em;margin-right:2em;margin-bottom:2em;margin-left:2em}
.docNoteTitle{font-family:Verdana,Arial,Helvetica,sans-serif;font-weight:bold}
.docNormalTitle,.docTipTitle{font-family:Verdana,Arial,Helvetica,sans-serif;font-weight:bold}
.docCautionsTitle{font-family:Verdana,Arial,Helvetica,sans-serif;color:#C00;font-weight:bold}
.docEmphasis{font-style:italic}
.docEmphBold,.docEmphStrong{font-weight:bold}
.docEmphGray{color:#999}
.docEmphMark{background-color:#999}
.docEmphRev{color:#FFF;background-color:#666}
.docEmphStrike{text-decoration:line-through}
.docEmphUl,.docEmphCursor{border-bottom-width:2px;border-bottom-style:solid;border-bottom-color:#000}
.docEmphBoldItalic{font-style:italic;font-weight:bold}
.docEmphRoman{font-style:normal;text-decoration:none;text-transform:none;font-weight:normal;font-variant:normal}
.docEmphSmaller{font-size:smaller}
.docCaps{text-transform:uppercase}
.docStructname{font-variant:small-caps}
pre{color:#790029;font-family:"Andale Mono","Courier New",Courier,monospace}
tt{color:#790029;font-family:"Andale Mono","Courier New",Courier,monospace}
div.ob_tree{overflow:auto}
div.ob_tree a{font-family:verdana,arial,sans-serif;font-size:13px;color:#00f}
td.ob_t2{font:8pt Tahoma;vertical-align:middle;border:0;background-color:transparent;padding-left:2px;padding-right:2px}
td.ob_t3{font:8pt Tahoma;vertical-align:middle;border:1px solid #666;background-color:#fff;padding-left:2px;padding-right:2px}
input.ob_t3{font:8pt Tahoma}
td.ob_t3 A{color:crimson}
td.ob_t4{display:none;vertical-align:top}
div.ob_d4{width:18px;font:6pt Tahoma}
div.ob_d5{width:15px;vertical-align:top;font:5px Verdana}
td.ob_t5v{background-image:url(/shared/images/tree/vertical.gif)}
td.ob_t6{width:16px;vertical-align:top}
td.ob_t6v{width:16px;vertical-align:top;background-image:url(/shared/images/tree/vertical.gif)}
td.ob_t8{width:16px;vertical-align:top}
td.ob_t7{font:8pt Tahoma;background-color:#fff;border:1px solid #666;color:#666;width:80px;text-align:center;padding-left:15px}
A.ob_a2{font:8pt Tahoma;color:#0000cd;TEXT-DECORATION:none}
.ob_t2c{border-collapse:separate;border-spacing:0}
.ob_t2b{border-collapse:separate;border-spacing:0}
.ob_t2g{border-collapse:separate;border-spacing:0}
.ob_t2g td{padding:0}
.ob_t2b td{padding:0}
.ob_t2c td{padding:0}
.gad{float:left;padding:10px 10px 0 0}
#floatMenu{position:absolute;top:150px;left:0}
#defaultChapterFont p{line-height:1.5em;margin:.4em 0 .5em}
#defaultChapterFont ul,#defaultChapterFont ol{margin-left:1.5em;padding-left:0}
#defaultChapterFont li{margin-bottom:.5em}
	</style>
	</head>
	<body style="font-size: 9pt ! important;">
		<div>
			Source: <a href="http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/">http://etutorials.org/Microsoft+Products/microsoft+windows+server+2003+terminal+services/Chapter+6+Registry/Registry+Keys+for+Terminal+Services/</a><br /><br />
			Additional Resources:<br />
			<li><a href="#"></a><br />
		</div>
		<div id="container" align="center">

  <div id="wrapper">

    <div id="header">
      <br clear="all">
      <h1 style="font-size: 24px; font-weight: bold; color: #00f;">Registry Keys for Terminal Services</h1>
      <br clear="all">
    </div>
    <br clear="all" />
  </div>

  <table cellpadding="0" cellspacing="0" border="0" id="main">
    <tr>
      <td id="leftCol">
       &nbsp;
      </td>
      <td id="rightCol">

      <div id="defaultChapterFont">
        <div class="chapter">

          <div class="section">
            <h2 class="first-section-title">Registry Keys for Terminal Services </h2>
            <p class="first-para">
              The relevant configuration options for terminal servers, terminal server sessions, users, and clients can be found in different places in the registry. The administration tools and Group Policies, described in the previous chapters, usually change several registry values. The following section provides you with information on their paths and default values.</p>
              <table border="0" cellspacing="0" cellpadding="0" class="note">
                <tr>
                  <td valign="top" class="admon-check">
                  </td>
                  <td valign="top" class="admon-title">Note?</td>
                  <td valign="top" class="admon-body">
                    <p class="first-para">This section is a general overview of those registry keys that are essential for Terminal Services. A full documentation of all relevant keys would probably be a book in its own right. However, if you know where to find the &#8220;interesting&#8221; locations, there is nothing to prevent you from doing your own experiments on a test system. Experiments have produced many tips for optimizing system performance by modifying the registry, just as described in this book.</p>
                  </td>
                </tr>
              </table>
              <div class="section">
                <h3 class="sect3-title">
                  General Settings</h3>
                  <p class="first-para">
                    We will first examine those areas of the registry that are vital to the global configuration of the terminal server and its sessions. These areas are located in the HKLM root hive.</p>
                    <p class="para">One of the central HKLM root hive areas can be found under SYSTEM\CurrentControlSet and SYSTEM\ControlSet00<i class="emphasis">n</i>. The numbered ControlSet001 and ControlSet002 subkeys contain control information that is needed to start and keep Windows Server 2003 running. One of these two numbered subkeys is the original; the other is the backup copy. On startup, the system determines which one of the keys is the original and saves the result under HKLM\SYSTEM\Select. The last successful set of control information is saved in HKLM\SYSTEM\CurrentControlSet. The three sets of control information are for the most part identical, but only one is valid and used by the system.</p>
                    <table border="0" cellspacing="0" cellpadding="0" class="note">
                      <tr>
                        <td valign="top" class="admon-check">
                        </td>
                        <td valign="top" class="admon-title">Note?</td>
                        <td valign="top" class="admon-body">
                          <p class="first-para">In the following, we assume that ControlSet001 contains the valid control information used by the system. On your system, it could be ControlSet002.</p>
                        </td>
                      </tr>
                    </table>
                    <p class="para">The HKLM\SYSTEM\ControlSet001HKLM\SYSTEM\ControlSet001\Control\Terminal Server hive allows you to configure general settings, just as you can under Terminal Services configuration or Group Policies. Some of the values described here will be discussed in detail later in this chapter.
                    </p>

                    <table class="table" width="100%" border="1">
                      <caption class="table-title">
                        <span class="table-title">
                          <span class="table-titlelabel">Table 6.2: </span> Registry Values in the HKLM\SYSTEM\ControlSet001HKLM\SYSTEM\ControlSet001\Control\Terminal Server Hive</span>
                        </caption>
                        <thead>
                          <tr valign="top">
                            <th class="th" scope="col" width="36%" align="left">
                              <p class="table-para">Value Names</p>
                            </th>
                            <th class="th" scope="col" width="20%" align="left">
                              <p class="table-para">Data Type, Default Value</p>
                            </th>
                            <th class="th" scope="col" width="44%" align="left">
                              <p class="table-para">Description</p>
                            </th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DeleteTempDirsOnExit</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Deletes temporary session directories when the user logs off. Possible values are 0 or 1. Change this value using the Delete temporary directories on exit server setting in Terminal Services configuration.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">fAllowToGetHelp</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x0</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Disables or enables remote assistance on this computer. Possible values are 0 or 1. Usually, this setting is established in the Remote tab of the Control Panel&#8217;s system properties.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">fDenyTSConnections</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x0</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Allows or denies connecting to Terminal Services. Possible values are 0 or 1.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">FirstCountMsgQPeeks-SleepBadApp</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0xF</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Default value of the compatibility flag for applications. (See &#8220;Compatibility Flags&#8221; section later in this chapter.)</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">fSingleSessionPerUser</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Each user can be limited to one session to save server resources or facilitate session recovery. Possible values are 0 or 1. Change this value using the Restrict each user to one session server setting in Terminal Services configuration.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">fWritableTSCCPermTab</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Allows write-protection of the Permissions tab in the Terminal Services configuration RDP connection settings. Possible values are 0 or 1.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">IdleWinStationPoolCount</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x0</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Sessions started in the background are assigned to new users. The default value for this setting is 0. For application servers, you can select different values, which might reduce login times for new user sessions.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">Modems With Bad DSR</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">MULTI_SZ</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">List of modems that have a problem with Data Set Ready (DSR).</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">MsgQBadAppSleep-TimeInMillisec</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Default value of the compatibility flag for applications. (See &#8220;Compatibility Flags&#8221; section later in this chapter.)</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">NthCountMsgQPeeksSleepBadApp</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x5</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Default value of the compatibility flag for applications. (See &#8220;Compatibility Flags&#8221; section later in this chapter.)</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">PerSessionTempDir</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Each user session receives its own temporary directory. Possible values for this setting are 0 or 1. Change this value using the Use per session directory server setting in Terminal Services configuration.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">ProductVersion</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">SZ: 5.2</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Version number of the terminal server.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">SessionDirectoryActive</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x0</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Indicates whether the session directory for this server is active. Possible values for this setting are 0 or 1.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">SessionDirectoryCLSID</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">SZ</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Class ID, needed by the session directory.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">SessionDirectoryExCLSID</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">SZ</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Another class ID that the session directory needs.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">SessionDirectoryExposeServerIP</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Indicates whether the server&#8217;s IP address is exposed with the activated session directory. Possible values for this setting are 0 or 1.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">TSAdvertise</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Indicates whether the server advertises itself as the terminal server. Possible values are 0 or 1.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">TSAppCompat</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Indicates whether the system is running in application compatibility mode. Possible values are 0 or 1.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">TSEnabled</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x1</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Indicates whether basic Terminal Services functions are enabled. Possible values are 0 or 1.</p>
                            </td>
                          </tr>
                          <tr valign="top">
                            <td class="td" width="36%" align="left">
                              <p class="table-para">
                                <i class="emphasis">TSUserEnabled</i>
                              </p>
                            </td>
                            <td class="td" width="20%" align="left">
                              <p class="table-para">
                                <i class="emphasis">DWORD: 0x0</i>
                              </p>
                            </td>
                            <td class="td" width="44%" align="left">
                              <p class="table-para">Indicates whether users can log on to the terminal server. Possible values are 0 or 1.</p>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                      <div class="figure">
                        <span class="figuremediaobject">
                          <img src="registry-keys-for-terminal-services_f06rq05.jpg" height="154" width="329" alt="Click To expand" border="0">
                        </span>
                        <br style="line-height: 1">
                        <span class="figure-title">
                          <span class="figure-titlelabel">Figure 6-5: </span>Registry values in the HKLM\SYSTEM\ControlSet001\Control\Terminal Server hive.</span>
                        </div>
                        <p class="last-para">
                          In addition to individual values, this path holds several subkeys that, in turn, contain keys and values for Terminal Services configuration.
                        </p>
                      </div>
                      <div class="section">
                        <h3 class="sect3-title">
                          Log and User Session Settings</h3>
                          <p class="first-para">
                            In Table 6.3, the last elements listed are the Wds and WinStations keys. They play a key role in configuring the RDP protocol and user sessions. Because some keys might exist in several hives, they should be explained in more detail. It is impossible to list and explain all keys in this book, so the following tables show only a selection of the most important configuration options. They can be found in one or more of these registry hives:</p>
                            <ul class="itemizedlist">
                              <li class="first-listitem">
                                <p class="first-para">HKLM\SYSTEM\ControlSet001\Control\Terminal Server\Wds\rdpwd</p>
                              </li>
                              <li class="listitem">
                                <p class="first-para">HKLM\SYSTEM\ControlSet001\Control\Terminal Server\Wds\rdpwd\Tds\tcp</p>
                              </li>
                              <li class="listitem">
                                <p class="first-para">HKLM\SYSTEM\ControlSet001\Control\Terminal Server\WinStation\Console</p>
                              </li>
                              <li class="listitem">
                                <p class="first-para">HKLM\SYSTEM\ControlSet001\Control\Terminal Server\WinStation\Console\RDP</p>
                              </li>
                              <li class="listitem">
                                <p class="first-para">HKLM\SYSTEM\ControlSet001\Control\Terminal Server \WinStation\RDP-Tcp.</p>
                                <p class="para">The values here are changed through the tool Terminal Services Configuration.</p>

                                <table class="table" width="100%" border="1">
                                  <caption class="table-title">
                                    <span class="table-title">
                                      <span class="table-titlelabel">Table 6.3: </span> The Most Important Subkeys in the HKLM\SYSTEM\ControlSet001HKLM\SYSTEM\ControlSet001\Control\Terminal Server Registry Hive</span>
                                    </caption>
                                    <thead>
                                      <tr valign="top">
                                        <th class="th" scope="col" width="40%" align="left">
                                          <p class="table-para">Subkeys</p>
                                        </th>
                                        <th class="th" scope="col" width="60%" align="left">
                                          <p class="table-para">Description</p>
                                        </th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">AddIns</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Configuration of the redirection of clipboard and client ports (redirector)</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">AuthorizedApplications</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Option to configure a list of applications that can be run on the terminal server</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">ClusterSettings</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Configuration of the session directory</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">DefaultUserConfiguration</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">All default Terminal Services configuration settings, for example, automatic logon data, time limits, initial program, etc.</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">Dos</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Adjusts DOS shell concerning query of keyboard events</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">KeyboardTypeMapping</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Adjusts keyboard driver for unusual shortcuts or special hardware</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">SysProcs</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">A list of system programs that run in the system context (0) or in the user context (1)</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">Utilities</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Adjusts the specific commands for the prompt: <b class="bold">Change logon</b>, <b class="bold">Change port</b>, <b class="bold">Change user</b>, <b class="bold">Change winsta</b>, <b class="bold">Query appserver</b>, <b class="bold">Query process</b>, <b class="bold">Query session</b>, <b class="bold">Query user</b>, <b class="bold">Query winsta</b>, <b class="bold">Reset session</b>, and <b class="bold">Reset winsta</b>
                                          </p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">VIDEO</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Device paths for graphics redirection</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">Wds</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Configuration of TCP/IP log settings, for example, delays, buffer attributes, port number, service name, and so on</p>
                                        </td>
                                      </tr>
                                      <tr valign="top">
                                        <td class="td" width="40%" align="left">
                                          <p class="table-para">WinStations</p>
                                        </td>
                                        <td class="td" width="60%" align="left">
                                          <p class="table-para">Specific configuration for each type of connection and the console session</p>
                                        </td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </li>
                              </ul>
                              <p class="para">
                                Table 6.4 lists the so-called <i class="emphasis">flags</i>. Flags are binary values that make a statement true (1) or false (0).
                              </p>

                              <table class="table" width="100%" border="1">
                                <caption class="table-title">
                                  <span class="table-title">
                                    <span class="table-titlelabel">Table 6.4: </span> List of Flags Under HKLM\SYSTEM\ControlSet001HKLM\SYSTEM\ControlSet001\Control\Terminal Server \Wds and \WinStations Data Type</span>
                                  </caption>
                                  <thead>
                                    <tr valign="top">
                                      <th class="th" scope="col" width="32%" align="left">
                                        <p class="table-para">Value Names (<i class="emphasis">DWORD</i>)</p>
                                      </th>
                                      <th class="th" scope="col" width="68%" align="left">
                                        <p class="table-para">Description</p>
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fAutoClientDrives</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Connect to client drives upon logon.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fAutoClientLpts</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Connect to client printers upon logon.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fDisableCam</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Disable client audio mapping.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fDisableCcm</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Disable client COM port mapping.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fDisableCdm</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Disable client drive mapping.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fDisableClip</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Disable clipboard mapping.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fDisableCpm</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Disable Windows client printer mapping.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fDisableEncryption</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Disable encryption.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fDisableExe</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Disable program start upon connection.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fDisableLPT</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Disable use of printers.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fEnableWinStation</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Enable remote user sessions.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fForceClientLptDef</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Use client main printer by default.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritAutoClient</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the setting on the terminal server to reset the connection when the connection was ended from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritAutoLogon</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the setting on the terminal server to use the client&#8217;s logon information for automatic logon from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritCallback</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the setting on the terminal server that a modem calls back from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritCallbackNumber</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit on the terminal server the phone number for modem callback from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritColorDepth</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the setting on the terminal server for color depth from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritInitialProgram</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the setting on the terminal server to start an initial program upon logon from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritMaxDisconnectionTime</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit on the terminal server the maximum time after which disconnected sessions are ended from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritMaxIdleTime</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit on the terminal server the maximum idle time for user sessions from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritMaxSessionTime</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit on the terminal server the maximum session time from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritReconnectSame</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the setting on the terminal server whether a new connection can be made only from the same client from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritResetBroken</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the setting on the terminal server, whether the session is ended upon reaching a session limit or upon disconnection from another source. If you do not set this flag, the session will be simply disconnected.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritSecurity</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the security setting on the terminal server.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fInheritShadow</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Inherit the setting on the terminal server for remote control from another source.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fLogonDisabled</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Selecting this flag disables logon.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fPromptForPassword</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Makes entering a password obligatory.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fReconnectSame</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">You can reconnect from the same client only as you did previously. This value becomes effective only if you set the <i class="emphasis">fInheritReconnectSame</i> flag.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fResetBroken</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">The session ends when a session limit is reached or the connection is broken. If this flag is not set, the session is simply disconnected. This value becomes effective only if you set the <i class="emphasis">fInheritResetBroken</i> flag.</p>
                                      </td>
                                    </tr>
                                    <tr valign="top">
                                      <td class="td" width="32%" align="left">
                                        <p class="table-para">
                                          <i class="emphasis">fUseDefaultGina</i>
                                        </p>
                                      </td>
                                      <td class="td" width="68%" align="left">
                                        <p class="table-para">Always use the default Windows component to authenticate users.</p>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                                <p class="para">
                                  Table 6.5 lists the most important keys with the <i class="emphasis">REG_DWORD</i> data type. These are often directly related to one of the flags listed in the preceding table.</p>

                                  <table class="table" width="100%" border="1">
                                    <caption class="table-title">
                                      <span class="table-title">
                                        <span class="table-titlelabel">Table 6.5: </span> The Most Important Keys of the <i class="emphasis">REG_DWORD</i> under HKLM\SYSTEM\ControlSet001HKLM\SYSTEM\ControlSet001\Control\Terminal Server\Wds and<i class="emphasis"> \WinStations</i> Data Type</span>
                                      </caption>
                                      <thead>
                                        <tr valign="top">
                                          <th class="th" scope="col" width="31%" align="left">
                                            <p class="table-para">Value Names <i class="emphasis">(DWORD)</i>
                                            </p>
                                          </th>
                                          <th class="th" scope="col" width="69%" align="left">
                                            <p class="table-para">Description</p>
                                          </th>
                                        </tr>
                                      </thead>
                                      <tbody>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">Callback</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Set modem callback. This value becomes effective only if you set the <i class="emphasis">fInheritCallback</i> flag to 0.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">ColorDepth</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Default color-depth setting.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">DrawGdiplusSupportLevel</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Support options for graphics elements output with GDI+.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">InputBufferLength</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Input buffer length for the RDP connection in bytes. Default value is 2048.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">KeyboardLayout</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Set keyboard layout.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">MaxConnectionTime</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Maximum session time in seconds. This value becomes effective only if you set the <i class="emphasis">fInheritMaxSessionTime</i> flag to 0.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">MaxDisconnectionTime</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Maximum time in seconds after which disconnected sessions are ended. This value becomes effective only if you set the <i class="emphasis">fInheritMaxDisconnectionTime</i> flag to 0.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">MaxIdleTime</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Maximum idle time in seconds for user sessions. This value becomes effective only if you set the <i class="emphasis">fInheritMaxIdleTime</i> flag to 0.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">MinEncryptionLevel</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Set the minimum value of encryption level.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">OutBufDelay</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Maximum waiting time in milliseconds until the output buffer for the RDP connection is emptied.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">OutBufLength</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Output buffer length for the RDP connection in bytes. </p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">PortNumber</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Port for network communication using the RDP protocol. Default value is 3398.</p>
                                          </td>
                                        </tr>
                                        <tr valign="top">
                                          <td class="td" width="31%" align="left">
                                            <p class="table-para">
                                              <i class="emphasis">Shadow</i>
                                            </p>
                                          </td>
                                          <td class="td" width="69%" align="left">
                                            <p class="table-para">Remote control configuration. This value becomes effective only if you set the <i class="emphasis">fInheritShadow</i> flag to 0.<br style="line-height:1">0: Deny remote control.<br style="line-height:1">1: Obtain user permission and interact with the session.<br style="line-height:1">2: Do not obtain user permission and interact with the session.<br style="line-height:1">3: Obtain user permission and display session.<br style="line-height:1">4: Do not obtain user permission and display session.</p>
                                          </td>
                                        </tr>
                                      </tbody>
                                    </table>
                                    <p class="para">Finally, Table 6.6 shows the most important keys of the <i class="emphasis">REG_SZ</i> data type.</p>

                                    <table class="table" width="100%" border="1">
                                      <caption class="table-title">
                                        <span class="table-title">
                                          <span class="table-titlelabel">Table 6.6: </span> The Most Important Keys of the <i class="emphasis">REG_SZ</i> under HKLM\SYSTEM\ControlSet001HKLM\SYSTEM\ControlSet001\Control\Terminal Server\Wds and \<i class="emphasis">WinStations</i> Data Type</span>
                                        </caption>
                                        <thead>
                                          <tr valign="top">
                                            <th class="th" scope="col" width="24%" align="left">
                                              <p class="table-para">Value Names <i class="emphasis">(SZ)</i>
                                              </p>
                                            </th>
                                            <th class="th" scope="col" width="76%" align="left">
                                              <p class="table-para">Description</p>
                                            </th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                          <tr valign="top">
                                            <td class="td" width="24%" align="left">
                                              <p class="table-para">
                                                <i class="emphasis">CallbackNumber</i>
                                              </p>
                                            </td>
                                            <td class="td" width="76%" align="left">
                                              <p class="table-para">Set a phone number for modem callback. This value becomes effective only if you set the fInheritCallbackNumber flag to 0.</p>
                                            </td>
                                          </tr>
                                          <tr valign="top">
                                            <td class="td" width="24%" align="left">
                                              <p class="table-para">
                                                <i class="emphasis">Comment</i>
                                              </p>
                                            </td>
                                            <td class="td" width="76%" align="left">
                                              <p class="table-para">Comment string in the administration tool.</p>
                                            </td>
                                          </tr>
                                          <tr valign="top">
                                            <td class="td" width="24%" align="left">
                                              <p class="table-para">
                                                <i class="emphasis">Domain</i>
                                              </p>
                                            </td>
                                            <td class="td" width="76%" align="left">
                                              <p class="table-para">Set a default domain name on logon of a user session.</p>
                                            </td>
                                          </tr>
                                          <tr valign="top">
                                            <td class="td" width="24%" align="left">
                                              <p class="table-para">
                                                <i class="emphasis">InitialProgram</i>
                                              </p>
                                            </td>
                                            <td class="td" width="76%" align="left">
                                              <p class="table-para">Initial program that is started when a user logs on. This value becomes effective only if you set the <i class="emphasis">fInheritInitialProgram</i> flag.</p>
                                            </td>
                                          </tr>
                                          <tr valign="top">
                                            <td class="td" width="24%" align="left">
                                              <p class="table-para">
                                                <i class="emphasis">NWLogonServer</i>
                                              </p>
                                            </td>
                                            <td class="td" width="76%" align="left">
                                              <p class="table-para">Set a NetWare logon server.</p>
                                            </td>
                                          </tr>
                                          <tr valign="top">
                                            <td class="td" width="24%" align="left">
                                              <p class="table-para">
                                                <i class="emphasis">Password</i>
                                              </p>
                                            </td>
                                            <td class="td" width="76%" align="left">
                                              <p class="table-para">Set a default password when logging on to a user session. The password is encrypted and saved here.</p>
                                            </td>
                                          </tr>
                                          <tr valign="top">
                                            <td class="td" width="24%" align="left">
                                              <p class="table-para">
                                                <i class="emphasis">UserName</i>
                                              </p>
                                            </td>
                                            <td class="td" width="76%" align="left">
                                              <p class="table-para">Set a default user name for logon to a user session.</p>
                                            </td>
                                          </tr>
                                          <tr valign="top">
                                            <td class="td" width="24%" align="left">
                                              <p class="table-para">
                                                <i class="emphasis">WorkDirectory</i>
                                              </p>
                                            </td>
                                            <td class="td" width="76%" align="left">
                                              <p class="table-para">Working directory that is set on user logon and initial start of an application.</p>
                                            </td>
                                          </tr>
                                        </tbody>
                                      </table>
                                    </div>
                                    <div class="section">
                                      <h3 class="sect3-title">
                                        Drivers and Services</h3>
                                        <p class="first-para">
                                          The HKLM\SYSTEM\ControlSet001\Services\TermDD hive contains the attributes of the Termdd.sys terminal device driver. However, do not change these attributes. You can find the device driver&#8217;s path and start option here.</p>
                                          <p class="para">An adjoining hive, called HKLM\SYSTEM\ControlSet001\Services\TermService, hosts both the configuration of Terminal Services within the generic Svchost.exe Windows service and of the Services.exe process. The keys you find there include, for example, the display name, description, complete path, or start options as also listed under services administration. The subkeys show license settings and parameters for the performance indicator object of the system monitor.</p>
                                          <div class="figure">
                                            <span class="figuremediaobject">
                                              <img src="registry-keys-for-terminal-services_f06rq06.jpg" height="118" width="329" alt="Click To expand" border="0">
                                            </span>
                                            <br style="line-height: 1">
                                            <span class="figure-title">
                                              <span class="figure-titlelabel">Figure 6-6: </span>Drivers and services for terminal server functions.</span>
                                            </div>

                                            <table border="0" cellspacing="0" cellpadding="0" class="note">
                                              <tr>
                                                <td valign="top" class="admon-check">
                                                </td>
                                                <td valign="top" class="admon-title">Note?</td>
                                                <td valign="top" class="admon-body">
                                                  <p class="first-para">The UseLicenseServer key under \Parameters is used by Windows NT 4.0, Terminal Server Edition. Windows Server 2003 no longer needs this key. It remains in the registry for compatibility reasons only.</p>
                                                </td>
                                              </tr>
                                            </table>
                                          </div>
                                          <div class="section">
                                            <h3 class="sect3-title">
                                              Logon</h3>
                                              <p class="first-para">
                                                If you log registry access in a focused manner during logon of a user session, you will gain interesting insights into the corresponding initialization processes. For example, which areas relevant for terminal servers does the Winlogon.exe logon process access?</p>
                                                <p class="para">One piece of information needed during logon concerns creating or loading the user profile. HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList. These keys contain the default paths for a default user (DefaultUser), general user (AllUsers), and individual user profiles. Furthermore, you can find a list of all users who have logged on to the system here. If a user logs on to the terminal server for the first time, he or she inherits both the normal default user settings and the default values for the terminal server session. They are saved under HKLM\SYSTEM\ControlSet001HKLM\SYSTEM\ControlSet001\Control\Terminal  Server\DefaultUserConfiguration.</p>
                                                <p class="para">Another relevant area is located under HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon. It includes the AppSetup key that defines a special script file called UsrLogon.cmd. This script file is executed along with a possible logon script on startup of each terminal server session. (See Chapter 7.) The same location also contains the WinStationDisabled key that either denies (0) or allows (1) new terminal server users to log on, regardless of the protocol. At the prompt, you can modify this value using the <b class="bold">Change logon /enable</b> or <b class="bold">Change logon /disable</b> prompts.</p>
                                                <p class="para">The HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\termsrv area is also needed for logon. It defines a specific logic as a response to system events.</p>
                                                <div class="figure">
                                                  <span class="figuremediaobject">
                                                    <img src="registry-keys-for-terminal-services_f06rq07.jpg" height="154" width="329" alt="Click To expand" border="0">
                                                  </span>
                                                  <br style="line-height: 1">
                                                  <span class="figure-title">
                                                    <span class="figure-titlelabel">Figure 6-7: </span>Determining the response to system events.</span>
                                                  </div>
                                                  <p class="para">When a user logs on, even driver configuration is accessed. The area reserved for terminal servers is located under HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32\Terminal Server\RDP. The video driver configuration plays a certain role for the user session, too. For instance, Explorer.exe needs the corresponding data that is located here: HKLM\SYSTEM\ControlSet001HKLM\SYSTEM\ControlSet001\Control\Terminal Server\VIDEO\rdpdd under the \Device\Video0 key.</p>
                                                  <p class="para">If local Group Policies for Terminal Services settings were established, these must be loaded at the right time, of course. This happens during logon with keys found under HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services and the EnableAdminTSRemote key under HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer. However, these areas can be fairly empty if no or just a few local Group Policies were predefined.</p>

                                                  <table border="0" cellspacing="0" cellpadding="0" class="note">
                                                    <tr>
                                                      <td valign="top" class="admon-check">
                                                      </td>
                                                      <td valign="top" class="admon-title">Note?</td>
                                                      <td valign="top" class="admon-body">
                                                        <p class="first-para">Basically, the settings for local Group Policies are located under HKCU\Software\Policies and HKLM\SOFTWARE\Policies. Users have only read-access rights to these two hives. Therefore, Group Policies cannot be modified at the user level.</p>
                                                      </td>
                                                    </tr>
                                                  </table>
                                                </div>
                                                <div class="section">
                                                  <h3 class="sect3-title">
                                                    Printing</h3>
                                                    <p class="first-para">
                                                      Connecting and managing printers for terminal servers is a very complex topic. (See Chapter 4.) This fact is also quite evident in the registry. The general configuration of the printers used and the associated driver information are located under HKLM\System\CurrentControlSet\Control\Print.</p>
                                                      <p class="para">You will find references to the currently installed printer drivers of the terminal server under HKLM\SYSTEM\ControlSet001\Control\Print\Environments\WindowsNTx86\Drivers\Version-3\&lt;<i class="emphasis">Printer name</i>&gt;. This correlates with the files under %SystemRoot%\system32\spool\drivers\w32x86\3. The user-specific settings for the printers are located in the registry under HKCU\Printers.</p>

                                                      <table border="0" cellspacing="0" cellpadding="0" class="note">
                                                        <tr>
                                                          <td valign="top" class="admon-check">
                                                          </td>
                                                          <td valign="top" class="admon-title">Note?</td>
                                                          <td valign="top" class="admon-body">
                                                            <p class="first-para">Information for the printer drivers for the Windows Server 2003 64 bit versions is located under HKLM\SYSTEM\ControlSet001\Control\Print \Environments\WindowsIA64\Drivers.</p>
                                                            <div class="figure">
                                                              <span class="figuremediaobject">
                                                                <img src="registry-keys-for-terminal-services_f06rq08.jpg" height="177" width="329" alt="Click To expand" border="0">
                                                              </span>
                                                              <br style="line-height: 1">
                                                              <span class="figure-title">
                                                                <span class="figure-titlelabel">Figure 6-8: </span>Configuring the print environment.</span>
                                                              </div>
                                                            </td>
                                                          </tr>
                                                        </table>
                                                        <p class="para">If you do not want to install printer drivers from sources that might not be controllable, you have the option of choosing a binding path. This path is called a <i class="emphasis">trusted printer driver path</i>. To configure this behavior, you need to add the following keys to HKLM\SYSTEM\ControlSet001\Control\Print\Providers\LanManPrintServices\servers:</p>
                                                        <ul class="itemizedlist">
                                                          <li class="first-listitem">
                                                            <p class="first-para">Name: LoadTrustedDrivers; type: REG_DWORD; value: 1</p>
                                                          </li>
                                                          <li class="listitem">
                                                            <p class="first-para">Name: TrustedDriverPath; type: REG_SZ; value: \\<i class="emphasis">Server name</i>\Share folder</p>
                                                          </li>
                                                        </ul>
                                                        <p class="last-para">It is important that the structure of the \\<i class="emphasis">Server name</i>\Share folder mirror the %SystemRoot%\system32\spool\drivers\w32x86 folder. If all the data was properly entered, printer drivers can be installed only from the predefined source, allowing complete control of the printer drivers used.</p>
                                                      </div>
                                                      <div class="section">
                                                        <h3 class="sect3-title">
                                                          User-Specific Configuration</h3>
                                                          <p class="first-para">
                                                            The registry&#8217;s user-specific section also contains keys that are relevant to the terminal server. For example, the HKCU\Software\Microsoft\Windows NT\CurrentVersion\Terminal Server hive has the key called LastUserIniSyncTime. This key indicates the last system time a user-specific .ini file was synchronized to its corresponding system-wide .ini file (discussed later in this chapter).</p>
                                                            <p class="para">If a user has administrator permissions, there is an additional key called TSADMIN here, containing several subkeys. These subkeys allow access to attributes for connection options, alerts, refresh rates, keyboard shortcuts for remote control, server list options, and display values for system processes in the Task Manager.</p>
                                                            <div class="figure">
                                                              <span class="figuremediaobject">
                                                                <img src="registry-keys-for-terminal-services_f06rq09.jpg" height="177" width="329" alt="Click To expand" border="0">
                                                              </span>
                                                              <br style="line-height: 1">
                                                              <span class="figure-title">
                                                                <span class="figure-titlelabel">Figure 6-9: </span>User-specific terminal server settings for an administrator.</span>
                                                              </div>
                                                              <p class="para">After a user session has been established, it has its own ID (SESSIONNAME). It is located next to the client name (CLIENTNAME) and the logon server name (LOGONSERVER) in the HKCU\Volatile Environment section of the registry.</p>
                                                              <p class="para">Use the following registry sections to define all relevant user folders in which to save data about the applications, desktop, local settings, personal files, network environment, print environment, or start menu:</p>
                                                              <ul class="itemizedlist">
                                                                <li class="first-listitem">
                                                                  <p class="first-para">HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</p>
                                                                </li>
                                                                <li class="listitem">
                                                                  <p class="first-para">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</p>
                                                                </li>
                                                              </ul>
                                                            </div>
                                                          </div>
                                                        </div>
                                                        <br>
                                                      </div>

                                                      <br clear="all" />

                                                    </td>
                                                  </tr>
                                                </table>

                                              </div>

		</div>
	</body>
</html>